<%
  // âœ… SAFETY: query will NEVER be undefined
  const q = query || {};
%>

<div class="products-page container">

  <!-- PAGE HEADER -->
  <div class="products-header">
    <h2 class="page-title">Our Yoga Products</h2>
    <p class="page-subtitle">
      Premium yoga mats, accessories & wellness essentials
    </p>
  </div>

  <!-- FILTER BAR -->
  <form method="GET" action="/products" class="filter-bar">

    <select name="category" class="filter-input">
      <option value="">All Categories</option>
      <option value="Accessories" <%= q.category === 'Accessories' ? 'selected' : '' %>>
        Accessories
      </option>
      <option value="Mats" <%= q.category === 'Mats' ? 'selected' : '' %>>
        Mats
      </option>
      <option value="Clothing" <%= q.category === 'Clothing' ? 'selected' : '' %>>
        Clothing
      </option>
    </select>

    <input
      type="number"
      name="minPrice"
      class="filter-input"
      placeholder="Min Price"
      value="<%= q.minPrice || '' %>"
    >

    <input
      type="number"
      name="maxPrice"
      class="filter-input"
      placeholder="Max Price"
      value="<%= q.maxPrice || '' %>"
    >

    <button type="submit" class="btn filter-btn">Filter</button>
  </form>

  <!-- PRODUCT GRID -->
  <div class="product-grid">
    <% if (products.length === 0) { %>
      <p>No products found.</p>
    <% } %>

    <% products.forEach(product => { %>
      <div class="product-card">

        <img
          src="<%= product.image %>"
          alt="<%= product.name %>"
          class="product-image"
        >

        <h3><%= product.name %></h3>
        <p><%= product.category %></p>
        <p>Rs <%= product.price %></p>

        <button class="btn">Add to Cart</button>
      </div>
    <% }) %>
  </div>

</div>
